define(function(){var r=Object,e=r.keys,t=Array.isArray,n={diff:function f(n,a){for(var i=e(n).sort(),l=e(a).sort(),o={},h={},s={},d=[],c={},g=0,u=0;i[g]||l[u];){var v=i[g],m=String.fromCharCode(g+48),y=l[u],A=n[v],C=a[y];if(v==y){if(r(A)===A&&r(C)===C){var p=f(A,C);e(p)[0]&&(c[m]=p)}else A!==C&&(s[m]=C);g++,u++}else v>y||!v?(h[y]=C,u++):(d.push(m),g++)}return d[0]&&(o.d=d),e(h)[0]&&(o.a=h),e(s)[0]&&(o.m=s),e(c)[0]&&(o.r=c),t(n)&&t(a)&&n.length>a.length&&(o.l=n.length-a.length),o},patch:function a(r,t){var n,f,i,l,o=e(r).sort();for(n in t)if("l"==n)r.length-=t.l;else for(f in t[n])i=t[n][f],l=o[("d"!=n?f:i).charCodeAt()-48],"a"==n?r[f]=i:"m"==n?r[l]=i:"d"==n?delete r[l]:a(r[l],i)}};return n});